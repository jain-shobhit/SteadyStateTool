function [K,F] = ElementStiffness(model,q)
E = model.E;
A = model.A;
dx = model.dx;
I = model.I;

u1 = q(1);
w1 = q(2);
t1 = q(3);
u2 = q(4);
w2 = q(5);
t2 = q(6);


K = [                                                                 (A*E)/dx,                                                                                                                                                                                                                                        -((A*E*(36*w1 - 36*w2))/30 + (A*E*dx*(3*t1 + 3*t2))/30)/dx^2,                                                                                                                                                                                                                   - (A*E*(4*t1 - t2))/30 - (A*E*(3*w1 - 3*w2))/(30*dx),                                                                        -(A*E)/dx,                                                                                                                                                                                                                                         ((A*E*(36*w1 - 36*w2))/30 + (A*E*dx*(3*t1 + 3*t2))/30)/dx^2,                                                                                                                                                                                                                     (A*E*(t1 - 4*t2))/30 - (A*E*(3*w1 - 3*w2))/(30*dx);
    (6*A*E*w2)/(5*dx^2) - (A*E*t2)/(10*dx) - (6*A*E*w1)/(5*dx^2) - (A*E*t1)/(10*dx), (12*E*I)/dx^3 - (6*A*E*u1)/(5*dx^2) + (6*A*E*u2)/(5*dx^2) + (9*A*E*t1^2)/(70*dx) + (9*A*E*t2^2)/(70*dx) + (108*A*E*w1^2)/(35*dx^3) + (108*A*E*w2^2)/(35*dx^3) + (27*A*E*t1*w1)/(35*dx^2) - (27*A*E*t1*w2)/(35*dx^2) + (27*A*E*t2*w1)/(35*dx^2) - (27*A*E*t2*w2)/(35*dx^2) - (216*A*E*w1*w2)/(35*dx^3),                           (6*E*I)/dx^2 - (3*A*E*t1^2)/280 + (3*A*E*t2^2)/280 - (A*E*u1)/(10*dx) + (A*E*u2)/(10*dx) + (27*A*E*w1^2)/(70*dx^2) + (27*A*E*w2^2)/(70*dx^2) + (3*A*E*t1*t2)/140 + (9*A*E*t1*w1)/(35*dx) - (9*A*E*t1*w2)/(35*dx) - (27*A*E*w1*w2)/(35*dx^2), (A*E*t1)/(10*dx) + (A*E*t2)/(10*dx) + (6*A*E*w1)/(5*dx^2) - (6*A*E*w2)/(5*dx^2), (6*A*E*u1)/(5*dx^2) - (12*E*I)/dx^3 - (6*A*E*u2)/(5*dx^2) - (9*A*E*t1^2)/(70*dx) - (9*A*E*t2^2)/(70*dx) - (108*A*E*w1^2)/(35*dx^3) - (108*A*E*w2^2)/(35*dx^3) - (27*A*E*t1*w1)/(35*dx^2) + (27*A*E*t1*w2)/(35*dx^2) - (27*A*E*t2*w1)/(35*dx^2) + (27*A*E*t2*w2)/(35*dx^2) + (216*A*E*w1*w2)/(35*dx^3),                           (6*E*I)/dx^2 + (3*A*E*t1^2)/280 - (3*A*E*t2^2)/280 - (A*E*u1)/(10*dx) + (A*E*u2)/(10*dx) + (27*A*E*w1^2)/(70*dx^2) + (27*A*E*w2^2)/(70*dx^2) + (3*A*E*t1*t2)/140 + (9*A*E*t2*w1)/(35*dx) - (9*A*E*t2*w2)/(35*dx) - (27*A*E*w1*w2)/(35*dx^2);
    (A*E*t2)/30 - (2*A*E*t1)/15 - (A*E*w1)/(10*dx) + (A*E*w2)/(10*dx),                                                       (6*E*I)/dx^2 - (3*A*E*t1^2)/280 + (3*A*E*t2^2)/280 - (A*E*u1)/(10*dx) + (A*E*u2)/(10*dx) + (27*A*E*w1^2)/(70*dx^2) + (27*A*E*w2^2)/(70*dx^2) + (3*A*E*t1*t2)/140 + (9*A*E*t1*w1)/(35*dx) - (9*A*E*t1*w2)/(35*dx) - (27*A*E*w1*w2)/(35*dx^2), (3*A*E*dx*t1^2)/35 - (3*A*E*dx*t1*t2)/140 - (3*A*E*t1*w1)/140 + (3*A*E*t1*w2)/140 + (A*E*dx*t2^2)/140 + (3*A*E*t2*w1)/140 - (3*A*E*t2*w2)/140 + (9*A*E*w1^2)/(70*dx) - (9*A*E*w1*w2)/(35*dx) + (9*A*E*w2^2)/(70*dx) - (2*A*E*u1)/15 + (2*A*E*u2)/15 + (4*E*I)/dx,             (2*A*E*t1)/15 - (A*E*t2)/30 + (A*E*w1)/(10*dx) - (A*E*w2)/(10*dx),                                                       (3*A*E*t1^2)/280 - (6*E*I)/dx^2 - (3*A*E*t2^2)/280 + (A*E*u1)/(10*dx) - (A*E*u2)/(10*dx) - (27*A*E*w1^2)/(70*dx^2) - (27*A*E*w2^2)/(70*dx^2) - (3*A*E*t1*t2)/140 - (9*A*E*t1*w1)/(35*dx) + (9*A*E*t1*w2)/(35*dx) + (27*A*E*w1*w2)/(35*dx^2),                                                                        (A*E*u1)/30 - (A*E*u2)/30 + (2*E*I)/dx - (3*A*E*dx*t1^2)/280 - (3*A*E*dx*t2^2)/280 + (3*A*E*t1*w1)/140 - (3*A*E*t1*w2)/140 + (3*A*E*t2*w1)/140 - (3*A*E*t2*w2)/140 + (A*E*dx*t1*t2)/70;
    -(A*E)/dx,                                                                                                                                                                                                                                         ((A*E*(36*w1 - 36*w2))/30 + (A*E*dx*(3*t1 + 3*t2))/30)/dx^2,                                                                                                                                                                                                                     (A*E*(4*t1 - t2))/30 + (A*E*(3*w1 - 3*w2))/(30*dx),                                                                         (A*E)/dx,                                                                                                                                                                                                                                        -((A*E*(36*w1 - 36*w2))/30 + (A*E*dx*(3*t1 + 3*t2))/30)/dx^2,                                                                                                                                                                                                                     (A*E*(3*w1 - 3*w2))/(30*dx) - (A*E*(t1 - 4*t2))/30;
    (A*E*t1)/(10*dx) + (A*E*t2)/(10*dx) + (6*A*E*w1)/(5*dx^2) - (6*A*E*w2)/(5*dx^2), (6*A*E*u1)/(5*dx^2) - (12*E*I)/dx^3 - (6*A*E*u2)/(5*dx^2) - (9*A*E*t1^2)/(70*dx) - (9*A*E*t2^2)/(70*dx) - (108*A*E*w1^2)/(35*dx^3) - (108*A*E*w2^2)/(35*dx^3) - (27*A*E*t1*w1)/(35*dx^2) + (27*A*E*t1*w2)/(35*dx^2) - (27*A*E*t2*w1)/(35*dx^2) + (27*A*E*t2*w2)/(35*dx^2) + (216*A*E*w1*w2)/(35*dx^3),                           (3*A*E*t1^2)/280 - (6*E*I)/dx^2 - (3*A*E*t2^2)/280 + (A*E*u1)/(10*dx) - (A*E*u2)/(10*dx) - (27*A*E*w1^2)/(70*dx^2) - (27*A*E*w2^2)/(70*dx^2) - (3*A*E*t1*t2)/140 - (9*A*E*t1*w1)/(35*dx) + (9*A*E*t1*w2)/(35*dx) + (27*A*E*w1*w2)/(35*dx^2), (6*A*E*w2)/(5*dx^2) - (A*E*t2)/(10*dx) - (6*A*E*w1)/(5*dx^2) - (A*E*t1)/(10*dx), (12*E*I)/dx^3 - (6*A*E*u1)/(5*dx^2) + (6*A*E*u2)/(5*dx^2) + (9*A*E*t1^2)/(70*dx) + (9*A*E*t2^2)/(70*dx) + (108*A*E*w1^2)/(35*dx^3) + (108*A*E*w2^2)/(35*dx^3) + (27*A*E*t1*w1)/(35*dx^2) - (27*A*E*t1*w2)/(35*dx^2) + (27*A*E*t2*w1)/(35*dx^2) - (27*A*E*t2*w2)/(35*dx^2) - (216*A*E*w1*w2)/(35*dx^3),                           (3*A*E*t2^2)/280 - (3*A*E*t1^2)/280 - (6*E*I)/dx^2 + (A*E*u1)/(10*dx) - (A*E*u2)/(10*dx) - (27*A*E*w1^2)/(70*dx^2) - (27*A*E*w2^2)/(70*dx^2) - (3*A*E*t1*t2)/140 - (9*A*E*t2*w1)/(35*dx) + (9*A*E*t2*w2)/(35*dx) + (27*A*E*w1*w2)/(35*dx^2);
    (A*E*t1)/30 - (2*A*E*t2)/15 - (A*E*w1)/(10*dx) + (A*E*w2)/(10*dx),                                                       (6*E*I)/dx^2 + (3*A*E*t1^2)/280 - (3*A*E*t2^2)/280 - (A*E*u1)/(10*dx) + (A*E*u2)/(10*dx) + (27*A*E*w1^2)/(70*dx^2) + (27*A*E*w2^2)/(70*dx^2) + (3*A*E*t1*t2)/140 + (9*A*E*t2*w1)/(35*dx) - (9*A*E*t2*w2)/(35*dx) - (27*A*E*w1*w2)/(35*dx^2),                                                                        (A*E*u1)/30 - (A*E*u2)/30 + (2*E*I)/dx - (3*A*E*dx*t1^2)/280 - (3*A*E*dx*t2^2)/280 + (3*A*E*t1*w1)/140 - (3*A*E*t1*w2)/140 + (3*A*E*t2*w1)/140 - (3*A*E*t2*w2)/140 + (A*E*dx*t1*t2)/70,             (2*A*E*t2)/15 - (A*E*t1)/30 + (A*E*w1)/(10*dx) - (A*E*w2)/(10*dx),                                                       (3*A*E*t2^2)/280 - (3*A*E*t1^2)/280 - (6*E*I)/dx^2 + (A*E*u1)/(10*dx) - (A*E*u2)/(10*dx) - (27*A*E*w1^2)/(70*dx^2) - (27*A*E*w2^2)/(70*dx^2) - (3*A*E*t1*t2)/140 - (9*A*E*t2*w1)/(35*dx) + (9*A*E*t2*w2)/(35*dx) + (27*A*E*w1*w2)/(35*dx^2), (A*E*dx*t1^2)/140 - (3*A*E*dx*t1*t2)/140 + (3*A*E*t1*w1)/140 - (3*A*E*t1*w2)/140 + (3*A*E*dx*t2^2)/35 - (3*A*E*t2*w1)/140 + (3*A*E*t2*w2)/140 + (9*A*E*w1^2)/(70*dx) - (9*A*E*w1*w2)/(35*dx) + (9*A*E*w2^2)/(70*dx) - (2*A*E*u1)/15 + (2*A*E*u2)/15 + (4*E*I)/dx];

F = [                                                                                                                                                                                                                                                                                                                                                                                       - ((A*E*(18*w1^2 - 36*w1*w2 + 18*w2^2))/30 - (A*E*dx*(30*u1 - 30*u2 - 3*t1*w1 + 3*t1*w2 - 3*t2*w1 + 3*t2*w2))/30)/dx^2 - (A*E*(2*t1^2 - t1*t2 + 2*t2^2))/30;
    (E*(3360*I*w1 - 3360*I*w2 + 288*A*w1^3 - 288*A*w2^3 - A*dx^3*t1^3 - A*dx^3*t2^3 + 1680*I*dx*t1 + 1680*I*dx*t2 + 864*A*w1*w2^2 - 864*A*w1^2*w2 - 28*A*dx^2*t1*u1 + 28*A*dx^2*t1*u2 - 28*A*dx^2*t2*u1 + 28*A*dx^2*t2*u2 + 108*A*dx*t1*w1^2 + 108*A*dx*t1*w2^2 + 108*A*dx*t2*w1^2 + 108*A*dx*t2*w2^2 + 3*A*dx^3*t1*t2^2 + 3*A*dx^3*t1^2*t2 + 36*A*dx^2*t1^2*w1 - 36*A*dx^2*t1^2*w2 + 36*A*dx^2*t2^2*w1 - 36*A*dx^2*t2^2*w2 - 336*A*dx*u1*w1 + 336*A*dx*u1*w2 + 336*A*dx*u2*w1 - 336*A*dx*u2*w2 - 216*A*dx*t1*w1*w2 - 216*A*dx*t2*w1*w2))/(280*dx^3);
    (E*(5040*I*w1 - 5040*I*w2 + 108*A*w1^3 - 108*A*w2^3 + 24*A*dx^3*t1^3 - 3*A*dx^3*t2^3 + 3360*I*dx*t1 + 1680*I*dx*t2 + 324*A*w1*w2^2 - 324*A*w1^2*w2 - 112*A*dx^2*t1*u1 + 112*A*dx^2*t1*u2 + 28*A*dx^2*t2*u1 - 28*A*dx^2*t2*u2 + 108*A*dx*t1*w1^2 + 108*A*dx*t1*w2^2 + 6*A*dx^3*t1*t2^2 - 9*A*dx^3*t1^2*t2 - 9*A*dx^2*t1^2*w1 + 9*A*dx^2*t1^2*w2 + 9*A*dx^2*t2^2*w1 - 9*A*dx^2*t2^2*w2 - 84*A*dx*u1*w1 + 84*A*dx*u1*w2 + 84*A*dx*u2*w1 - 84*A*dx*u2*w2 - 216*A*dx*t1*w1*w2 + 18*A*dx^2*t1*t2*w1 - 18*A*dx^2*t1*t2*w2))/(840*dx^2);
    ((A*E*(18*w1^2 - 36*w1*w2 + 18*w2^2))/30 - (A*E*dx*(30*u1 - 30*u2 - 3*t1*w1 + 3*t1*w2 - 3*t2*w1 + 3*t2*w2))/30)/dx^2 + (A*E*(2*t1^2 - t1*t2 + 2*t2^2))/30;
    -(E*(3360*I*w1 - 3360*I*w2 + 288*A*w1^3 - 288*A*w2^3 - A*dx^3*t1^3 - A*dx^3*t2^3 + 1680*I*dx*t1 + 1680*I*dx*t2 + 864*A*w1*w2^2 - 864*A*w1^2*w2 - 28*A*dx^2*t1*u1 + 28*A*dx^2*t1*u2 - 28*A*dx^2*t2*u1 + 28*A*dx^2*t2*u2 + 108*A*dx*t1*w1^2 + 108*A*dx*t1*w2^2 + 108*A*dx*t2*w1^2 + 108*A*dx*t2*w2^2 + 3*A*dx^3*t1*t2^2 + 3*A*dx^3*t1^2*t2 + 36*A*dx^2*t1^2*w1 - 36*A*dx^2*t1^2*w2 + 36*A*dx^2*t2^2*w1 - 36*A*dx^2*t2^2*w2 - 336*A*dx*u1*w1 + 336*A*dx*u1*w2 + 336*A*dx*u2*w1 - 336*A*dx*u2*w2 - 216*A*dx*t1*w1*w2 - 216*A*dx*t2*w1*w2))/(280*dx^3);
    (E*(5040*I*w1 - 5040*I*w2 + 108*A*w1^3 - 108*A*w2^3 - 3*A*dx^3*t1^3 + 24*A*dx^3*t2^3 + 1680*I*dx*t1 + 3360*I*dx*t2 + 324*A*w1*w2^2 - 324*A*w1^2*w2 + 28*A*dx^2*t1*u1 - 28*A*dx^2*t1*u2 - 112*A*dx^2*t2*u1 + 112*A*dx^2*t2*u2 + 108*A*dx*t2*w1^2 + 108*A*dx*t2*w2^2 - 9*A*dx^3*t1*t2^2 + 6*A*dx^3*t1^2*t2 + 9*A*dx^2*t1^2*w1 - 9*A*dx^2*t1^2*w2 - 9*A*dx^2*t2^2*w1 + 9*A*dx^2*t2^2*w2 - 84*A*dx*u1*w1 + 84*A*dx*u1*w2 + 84*A*dx*u2*w1 - 84*A*dx*u2*w2 - 216*A*dx*t2*w1*w2 + 18*A*dx^2*t1*t2*w1 - 18*A*dx^2*t1*t2*w2))/(840*dx^2)];

